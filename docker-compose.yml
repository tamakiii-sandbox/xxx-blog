version: "3.7"
services:
  nginx:
    build:
      context: .
      dockerfile: nginx.dockerfile
      target: ${ENVIRONMENT:-production-pseudo}
      # labels:
      #   com.docker.compose.project: ${PROJECT_NAME}
      #   com.docker.compose.service: nginx
    volumes:
      - .:/web/xxx-blog

  php-fpm:
    build:
      context: .
      dockerfile: php-fpm.dockerfile
      target: ${ENVIRONMENT:-production-pseudo}
      # labels:
      #   com.docker.compose.project: ${PROJECT_NAME}
      #   com.docker.compose.service: php-fpm
    volumes:
      - .:/web/xxx-blog

  alb:
    build:
      context: docker/alb
      target: development
    ports:
      - ${ALB_PORT:-443}:443
